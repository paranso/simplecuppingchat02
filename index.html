<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>간단 커핑 앱</title>
  <style>
    body { font-family: sans-serif; background-color: #f9f9f9; padding: 20px; }
    .container { background-color: #fff; padding: 30px; border-radius: 8px; max-width: 800px; margin: auto; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1, h2 { text-align: center; color: #333; }
    h2 { margin-top: 30px; }
    .section { margin-bottom: 25px; }
    label { display: block; margin-bottom: 8px; font-weight: bold; }
    input[type="text"],
    input[type="date"],
    textarea { width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px; }
    textarea { resize: vertical; min-height: 80px; }
    .options { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 8px; }
    .options label { font-weight: normal; cursor: pointer; }
    input[type="range"] { width: 100%; }
    button { display: block; width: 100%; padding: 12px; background-color: #007bff; color: #fff; border: none; border-radius: 5px; font-size: 1em; cursor: pointer; margin-top: 20px; }
    button:hover { background-color: #0056b3; }
    pre { background-color: #f0f0f0; padding: 15px; border-radius: 4px; overflow-x: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>간단 커핑 앱</h1>
    
    <!-- 기본 정보 입력 -->
    <div class="section" id="basic-info">
      <h2>기본 정보 입력</h2>
      <label>로스팅 날짜
        <input type="date" id="roasting-date">
      </label>
      <label>커핑 날짜
        <input type="date" id="cupping-date">
      </label>
      <label>커피 정보
        <input type="text" id="coffee-name" placeholder="예) 에티오피아 예가체프">
      </label>
      <label>배출온도/시간
        <input type="text" id="drop-temp" placeholder="예) 215℃ / 11분 45초">
      </label>
      <label>Agtron#
        <input type="text" id="agtron" placeholder="예) 65">
      </label>
    </div>
    
    <!-- 1. 향 맡기 -->
    <div class="section" id="aroma-section">
      <h2>1. 향 맡기</h2>
      <div class="options">
        <label><input type="checkbox" value="꽃향">꽃향</label>
        <label><input type="checkbox" value="과일향">과일향</label>
        <label><input type="checkbox" value="허브향">허브향</label>
        <label><input type="checkbox" value="견과류향">견과류향</label>
        <label><input type="checkbox" value="카라멜향">카라멜향</label>
        <label><input type="checkbox" value="초콜릿향">초콜릿향</label>
        <label><input type="checkbox" value="기타향">기타향</label>
      </div>
      <label>기타 향
        <input type="text" id="aroma-text" placeholder="기타 향 입력">
      </label>
      <label>향 만족도
        <input type="range" id="aroma-rating" min="1" max="5" value="3">
      </label>
    </div>
    
    <!-- 2. 맛보기 -->
    <div class="section" id="taste-section">
      <h2>2. 맛보기</h2>
      <div class="options">
        <label><input type="checkbox" value="단맛">단맛</label>
        <label><input type="checkbox" value="신맛">신맛</label>
        <label><input type="checkbox" value="쓴맛">쓴맛</label>
        <label><input type="checkbox" value="기타맛">기타맛</label>
      </div>
      <label>기타 맛
        <input type="text" id="taste-text" placeholder="기타 맛 입력">
      </label>
      <label>맛 만족도
        <input type="range" id="taste-rating" min="1" max="5" value="3">
      </label>
    </div>
    
    <!-- 3. 전체적인 느낌 -->
    <div class="section" id="feel-section">
      <h2>3. 전체적인 느낌</h2>
      <div class="options">
        <label><input type="checkbox" value="부드러움">부드러움</label>
        <label><input type="checkbox" value="묵직함">묵직함</label>
        <label><input type="checkbox" value="깔끔함">깔끔함</label>
        <label><input type="checkbox" value="씁쓸함">씁쓸함</label>
        <label><input type="checkbox" value="달콤함">달콤함</label>
        <label><input type="checkbox" value="상큼함">상큼함</label>
        <label><input type="checkbox" value="기타느낌">기타느낌</label>
      </div>
      <label>기타 느낌
        <input type="text" id="feel-text" placeholder="기타 느낌 입력">
      </label>
      <label>느낌 만족도
        <input type="range" id="overall-rating" min="1" max="5" value="3">
      </label>
    </div>
    
    <!-- 4. 추가 메모 -->
    <div class="section" id="additional-info">
      <h2>4. 추가 메모</h2>
      <textarea id="additional-note" placeholder="추가 메모 입력"></textarea>
    </div>
    
    <!-- 5. 로스팅 추천 방향 -->
    <div class="section" id="roasting-recommendation-section">
      <h2>5. 로스팅 추천 방향</h2>
      <textarea id="roasting-recommendation" placeholder="로스팅 추천 입력"></textarea>
    </div>
    
    <button id="save-button">결과 저장</button>
    
    <!-- 결과 출력 영역 -->
    <pre id="result-display"></pre>
  </div>
  
  <script>
    // 저장 버튼 클릭 시 모든 입력값을 가져와 JSON 데이터로 만들어 전송
    document.getElementById("save-button").addEventListener("click", function() {
      // 기본 정보
      const roastingDate = document.getElementById("roasting-date").value;
      const cuppingDate = document.getElementById("cupping-date").value;
      const coffeeName = document.getElementById("coffee-name").value.trim();
      const dropTemp = document.getElementById("drop-temp").value.trim();
      const agtron = document.getElementById("agtron").value.trim();
      
      // 1. 향 맡기
      const aromaSection = document.getElementById("aroma-section");
      const aromaChoices = Array.from(aromaSection.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
      const aromaCustomText = document.getElementById("aroma-text").value.trim();
      const aromaRating = parseInt(document.getElementById("aroma-rating").value) || 0;
      
      // 2. 맛보기
      const tasteSection = document.getElementById("taste-section");
      const tasteChoices = Array.from(tasteSection.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
      const tasteCustomText = document.getElementById("taste-text").value.trim();
      const tasteRating = parseInt(document.getElementById("taste-rating").value) || 0;
      
      // 3. 전체적인 느낌
      const feelSection = document.getElementById("feel-section");
      const feelChoices = Array.from(feelSection.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
      const feelCustomText = document.getElementById("feel-text").value.trim();
      const overallRating = parseInt(document.getElementById("overall-rating").value) || 0;
      
      // 4. 추가 메모 & 5. 로스팅 추천
      const additionalNote = document.getElementById("additional-note").value.trim();
      const roastingRecommendation = document.getElementById("roasting-recommendation").value.trim();
      
      // 데이터 객체 구성
      const dataToSend = {
        roastingDate,
        cuppingDate,
        coffeeName,
        dropTemp,
        agtron,
        aromaChoices: aromaChoices.join(", "),
        aromaCustomText,
        aromaRating,
        tasteChoices: tasteChoices.join(", "),
        tasteCustomText,
        tasteRating,
        feelChoices: feelChoices.join(", "),
        feelCustomText,
        overallRating,
        additionalNote,
        roastingRecommendation
      };
      
      // 결과 출력 (디버깅용)
      document.getElementById("result-display").textContent = JSON.stringify(dataToSend, null, 2);
      
      // Google Apps Script 웹앱으로 POST 요청 전송
      fetch("https://script.google.com/macros/s/AKfycbyUr_KtGhArKvno9vMqUXfNHXYXRaddwqEcix5OFwyOQn0ixcpXtv_85k2oyDtambaiYw/exec", {
        method: "POST",
        headers: { "Content-Type": "text/plain;charset=utf-8" },
        body: JSON.stringify(dataToSend)
      })
      .then(response => response.json())
      .then(result => {
        if(result.status === "success"){
          alert("데이터 저장 성공!");
        } else {
          alert("저장 오류: " + result.message);
        }
      })
      .catch(error => {
        alert("저장 중 오류 발생: " + error.message);
      });
    });
  </script>
</body>
</html>
